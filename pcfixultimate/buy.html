<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø´Ø±Ø§Ø¡ ØªØ±Ø®ÙŠØµ PCFixUltimate</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#0a0a0a;color:#e0e0e0;margin:0;padding:24px}
    .card{max-width:760px;margin:0 auto;background:#141414;border:1px solid #1f1f1f;border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.4);padding:24px}
    h1{margin:0 0 12px;font-size:24px}
    .muted{color:#9aa0a6;font-size:14px;margin-bottom:18px}
    label{display:block;margin:16px 0 6px}
    input,textarea{width:100%;background:#0a0a0a;border:1px solid #1f1f1f;border-radius:10px;color:#e0e0e0;padding:10px}
    textarea{min-height:120px}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button{background:linear-gradient(#1a73e8,#1662c9);border:1px solid #1662c9;color:#fff;padding:10px 16px;border-radius:10px;font-weight:700;cursor:pointer}
    button.secondary{background:#222;border-color:#333}
    .ok{color:#34a853}
    .err{color:#ff5252}
    .pill{display:inline-block;padding:6px 10px;border:1px solid #1f1f1f;border-radius:999px;background:#0a0a0a;color:#aeb3b7;font-size:12px}
    .grid{display:grid;grid-template-columns:1fr;gap:14px}
    .foot{margin-top:18px;color:#9aa0a6;font-size:12px}
    code{background:#0a0a0a;border:1px solid #1f1f1f;border-radius:6px;padding:2px 6px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Ø´Ø±Ø§Ø¡ / ØªÙØ¹ÙŠÙ„ PCFixUltimate</h1>
    <div class="muted">ØªØªØ­Ù‚Ù‚ ØµÙØ­Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ù† Ø¨ØµÙ…Ø© Ø¬Ù‡Ø§Ø²Ùƒ ÙˆØªÙˆÙ„Ù‘Ø¯ Ù„Ùƒ ÙƒÙˆØ¯ ØªØ±Ø®ÙŠØµ Ù…ÙˆÙ‚Ù‘Ø¹ ÙŠÙÙØ¹Ù‘ÙÙ„ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø² ÙÙ‚Ø·.</div>

    <div class="grid">
      <div>
        <label>Ø¨ØµÙ…Ø© Ø¬Ù‡Ø§Ø²Ùƒ (machine_hash)</label>
        <input id="mh" placeholder="Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¥Ù† Ø¬Ø¦Øª Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚" />
        <div class="muted">Ø¥Ù† ÙƒØ§Ù†Øª ÙØ§Ø±ØºØ©ØŒ Ø§Ù†Ø³Ø®Ù‡Ø§ Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: <span class="pill">Settings â†’ Buy License</span></div>
      </div>

      <div>
        <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ API</label>
        <input id="api" placeholder="https://pcfix-license-api.pcfixultimate.workers.dev/generate" />
      </div>

      <div class="row">
        <button id="pay">ğŸ’³ Ø§Ø¯ÙØ¹ Ø§Ù„Ø¢Ù† (ØªØ¬Ø±ÙŠØ¨ÙŠ)</button>
        <button id="gen">âš¡ ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„</button>
        <button id="copy" class="secondary">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
      </div>

      <div>
        <label>ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ (License Token)</label>
        <textarea id="token" readonly placeholder="Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙˆÙ„ÙŠØ¯"></textarea>
      </div>

      <div id="status" class="muted"></div>
    </div>

    <div class="foot">
      Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØªÙ… Ø±Ø¨Ø· Ø§Ù„ØªØ±Ø®ÙŠØµ Ø¨Ø¬Ù‡Ø§Ø² ÙˆØ§Ø­Ø¯ Ø¹Ø¨Ø± <code>machine_hash</code>. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø£Ù…Ø§Ù†.
    </div>
  </div>

  <script>
    // Ù‚Ø±Ø§Ø¡Ø© Ø¨Ø§Ø±Ø§Ù…ØªØ±Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø·
    const qs = new URLSearchParams(location.search);
    const $ = (id) => document.getElementById(id);
    const mhInput = $("mh");
    const apiInput = $("api");
    const tokenBox = $("token");
    const statusBox = $("status");

    // ØªØ¹Ø¨Ø¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¥Ù† ÙˆÙØ¬Ø¯Øª mh Ùˆ api ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·
    if (qs.get("mh")) mhInput.value = qs.get("mh");
    if (qs.get("api")) apiInput.value = qs.get("api");

    // Ø²Ø± Ø¯ÙØ¹ (ØªØ¬Ø±ÙŠØ¨ÙŠ - Ø§Ù„Ø¢Ù† ÙÙ‚Ø· ÙŠØ¹Ø±Ø¶ Ù†Ø¬Ø§Ø­ ÙˆÙ‡Ù…ÙŠ)
    $("pay").addEventListener("click", () => {
      statusBox.textContent = "ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­ (ØªØ¬Ø±ÙŠØ¨ÙŠ). ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯.";
      statusBox.className = "ok";
    });

    // Ø²Ø± ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯
    $("gen").addEventListener("click", async () => {
      const mh = mhInput.value.trim();
      const api = (apiInput.value.trim() || "https://pcfix-license-api.pcfixultimate.workers.dev/generate");

      if (!mh) {
        statusBox.textContent = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ machine_hash.";
        statusBox.className = "err";
        return;
      }

      try {
        statusBox.textContent = "Ø¬Ø§Ø±Ù ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯...";
        statusBox.className = "muted";

        const url = `${api}?mh=${encodeURIComponent(mh)}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        if (!data.token) throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙ„Ø§Ù… token Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….");

        tokenBox.value = data.token;
        statusBox.textContent = "ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­.";
        statusBox.className = "ok";
      } catch (e) {
        statusBox.textContent = "Ø®Ø·Ø£: " + e.message;
        statusBox.className = "err";
      }
    });

    // Ø²Ø± Ù†Ø³Ø®
    $("copy").addEventListener("click", async () => {
      if (!tokenBox.value) {
        statusBox.textContent = "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙƒÙˆØ¯ Ù„Ù†Ø³Ø®Ù‡.";
        statusBox.className = "err";
        return;
      }
      try {
        await navigator.clipboard.writeText(tokenBox.value);
        statusBox.textContent = "ØªÙ… Ø§Ù„Ù†Ø³Ø® Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©.";
        statusBox.className = "ok";
      } catch {
        statusBox.textContent = "ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ù†Ø³Ø®. Ø§Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠÙ‹Ø§.";
        statusBox.className = "err";
      }
    });
  </script>
</body>
</html>
